Class {
	#name : #Syfter,
	#superclass : #Object,
	#instVars : [
		'project'
	],
	#category : #'VulnerabilityVisualizer-Core'
}

{ #category : #'instance creation' }
Syfter class >> on: aProject [

	^ self new
		  setProject: aProject;
		  yourself
]

{ #category : #processing }
Syfter >> process: anImage [

	| syft artifacts |
	syft := VVProject syftJson: anImage packageUrl dockerIdentifier.
	artifacts := (syft at: 'artifacts') collect: [ :each | 
		             VVPackage packageUrlString: (each at: 'purl') ].
	artifacts do: [ :each | project addPackage: each ].
	
]

{ #category : #initialization }
Syfter >> setProject: aProject [

	project := aProject
]
