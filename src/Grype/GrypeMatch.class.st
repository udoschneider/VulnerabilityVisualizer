Class {
	#name : #GrypeMatch,
	#superclass : #Object,
	#instVars : [
		'artifact',
		'relatedVulnerabilities',
		'matchDetails',
		'vulnerability'
	],
	#category : #'Grype-Core'
}

{ #category : #accessing }
GrypeMatch class >> neoJsonMapping: mapper [

	mapper for: self do: [ :mapping | 
		mapping mapInstVars:
			#( artifact relatedVulnerabilities matchDetails vulnerability ).

		(mapping mapInstVar: #artifact) valueSchema: GrypeArtifact.
		(mapping mapInstVar: #matchDetails) valueSchema: #ArrayOfMatchDetail.
		(mapping mapInstVar: #relatedVulnerabilities) valueSchema:
			#ArrayOfVulnerability.
		(mapping mapInstVar: #vulnerability) valueSchema:
			GrypeVulnerability ].

	mapper
		for: #ArrayOfMatchDetail
		customDo: [ :mapping | 
		mapping listOfElementSchema: GrypeMatchDetails ].
	mapper
		for: #ArrayOfVulnerability
		customDo: [ :mapping | 
		mapping listOfElementSchema: GrypeVulnerability ]
]

{ #category : #accessing }
GrypeMatch >> artifact [
	^ artifact
]
