Class {
	#name : #GrypeVulnerability,
	#superclass : #GrypeObject,
	#instVars : [
		'urls',
		'namespace',
		'description',
		'cvss',
		'severity',
		'fix',
		'advisories',
		'id',
		'dataSource'
	],
	#category : #'Grype-Core'
}

{ #category : #accessing }
GrypeVulnerability class >> neoJsonMapping: mapper [

	mapper for: self do: [ :mapping | 
		mapping mapInstVars:
			#( urls namespace description cvss severity fix advisories
			   id dataSource ).

		(mapping mapInstVar: #urls) valueSchema: #ArrayOfURL.
		(mapping mapInstVar: #dataSource) valueSchema: ZnUrl ].

	mapper
		for: #ArrayOfURL
		customDo: [ :mapping | mapping listOfElementSchema: ZnUrl ]
]

{ #category : #accessing }
GrypeVulnerability >> dataSource [
	^ dataSource
]

{ #category : #accessors }
GrypeVulnerability >> id [
	^ id
]

{ #category : #printing }
GrypeVulnerability >> printOn: aStream [

	super printOn: aStream.
	aStream
		space;
		nextPut: $(;
		nextPutAll: id;
		nextPut: $)
]
