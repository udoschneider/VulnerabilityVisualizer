Class {
	#name : #GrypeTarget,
	#superclass : #Object,
	#instVars : [
		'repoDigests',
		'layers',
		'manifest',
		'imageSize',
		'manifestDigest',
		'imageID',
		'config',
		'tags',
		'userInput',
		'mediaType'
	],
	#category : #'Grype-Core'
}

{ #category : #accessing }
GrypeTarget class >> neoJsonMapping: mapper [

	mapper for: self do: [ :mapping | 
		mapping mapInstVars:
			#( repoDigests layers manifest imageSize manifestDigest
			   imageID config tags userInput mediaType ).
		(mapping mapInstVar: #manifestDigest) valueSchema: GrypeChecksum.
		(mapping mapInstVar: #imageID) valueSchema: GrypeChecksum.
		(mapping mapInstVar: #mediaType) valueSchema: ZnMimeType.
		(mapping mapInstVar: #manifest) valueSchema: #Base64EncodedJson.
		(mapping mapInstVar: #repoDigests) valueSchema: #ArrayOfRepoDigest.
		(mapping mapInstVar: #layers) valueSchema: #ArrayOfLayer.
		(mapping mapInstVar: #config) valueSchema: #Base64EncodedJson ].

	mapper
		for: #ArrayOfRepoDigest
		customDo: [ :mapping | 
			mapping listOfElementSchema: GrypeRepoDigest ];
		for: #ArrayOfLayer
		customDo: [ :mapping | mapping listOfElementSchema: GrypeLayer ]
]
