Class {
	#name : #GrypeTests,
	#superclass : #TestCase,
	#category : #'Grype-Tests'
}

{ #category : #tests }
GrypeTests >> testChecksum [

	| checksum |
	checksum := GrypeChecksum fromString:
		            'sha256:29fd09b3aec00f084e50e9201a7f19f8ae9988c9cb072aba7c11ac6ea26d88aa'.
	self assert: checksum algorithm equals: 'sha256'.
	self assert: (checksum value isKindOf: ByteArray).
	self
		assert: checksum value asInteger
		equals:
		16r29fd09b3aec00f084e50e9201a7f19f8ae9988c9cb072aba7c11ac6ea26d88aa
]

{ #category : #tests }
GrypeTests >> testPlayground [

	| fr grype |
	fr := FileLocator home / 'grype.json'.
	grype := fr readStreamDo: [ :stream | 
		         (NeoJSONReader on: stream) nextAs: GrypeModel ].

	self assert: grype source type equals: 'image'
]
