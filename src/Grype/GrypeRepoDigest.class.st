Class {
	#name : #GrypeRepoDigest,
	#superclass : #Object,
	#instVars : [
		'digest',
		'repository'
	],
	#category : #'Grype-Core'
}

{ #category : #'instance creation' }
GrypeRepoDigest class >> fromString: aString [

	| splitted |
	splitted := $@ split: aString.
	^ self
		  repository: splitted first
		  digest: (GrypeChecksum fromString: splitted second)
]

{ #category : #accessing }
GrypeRepoDigest class >> neoJsonMapping: mapper [

	mapper for: self customDo: [ :mapping | 
		mapping
			decoder: [ :string | self fromString: string ];
			encoder: [ :checksum | self halt ] ]
]

{ #category : #'instance creation' }
GrypeRepoDigest class >> repository: aString digest: aDVVGrypeChecksum [

	^ self new
		  setRepository: aString digest: aDVVGrypeChecksum;
		  yourself
]

{ #category : #printing }
GrypeRepoDigest >> printOn: aStream [

	super printOn: aStream.

	aStream
		space;
		nextPut: $(;
		nextPutAll: repository;
		nextPut: $@;
		print: digest;
		nextPut: $)
]

{ #category : #initialization }
GrypeRepoDigest >> setRepository: aString digest: aDVVGrypeChecksum [

	repository := aString.
	digest := aDVVGrypeChecksum
]
