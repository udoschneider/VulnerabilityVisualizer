Class {
	#name : #GrypeChecksum,
	#superclass : #GrypeObject,
	#instVars : [
		'algorithm',
		'value'
	],
	#category : #'Grype-Core'
}

{ #category : #'instance creation' }
GrypeChecksum class >> algorithm: aString value: aByteArray [

	^ self new
		  setAlgorithm: aString value: aByteArray;
		  yourself
]

{ #category : #'instance creation' }
GrypeChecksum class >> fromString: aString [

	| splitted |
	splitted := $: split: aString.
	^ self
		  algorithm: splitted first
		  value: (ByteArray readHexFrom: splitted second)
]

{ #category : #accessing }
GrypeChecksum class >> neoJsonMapping: mapper [

	mapper for: self customDo: [ :mapping | 
		mapping
			decoder: [ :string | self fromString: string ];
			encoder: [ :checksum | self halt ] ]
]

{ #category : #accessing }
GrypeChecksum >> algorithm [
	^ algorithm
]

{ #category : #printing }
GrypeChecksum >> printOn: aStream [

	aStream
		nextPutAll: algorithm;
		nextPut: $:.
	value printHexOn: aStream
]

{ #category : #initialization }
GrypeChecksum >> setAlgorithm: aString value: aByteArray [

	algorithm := aString.
	value := aByteArray
]

{ #category : #accessing }
GrypeChecksum >> value [

	^ value
]
